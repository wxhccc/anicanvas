{"version":3,"file":"anicanvas.js","sources":["../../src/utils.js","../../src/core/sprite.js","../../src/core/Layer.js","../../src/core/Stage.js","../../src/core/Sprite.js","../../src/core/Painter.js","../../src/core/CommonPainter.js","../../src/core/AnimationTimer.js","../../src/core/Behavior.js","../../src/core/MediaLoader.js","../../src/index.js"],"sourcesContent":["/*\n* 公共函数\n*/\n/* 创建dom元素 */\nexport function createHtmlElement(tag, attrs, styles){\n  let elem = document.createElement(tag);\n  isType(attrs, 'object') && Object.assign(elem, attrs);\n  isType(styles, 'object') && Object.assign(elem.style, styles);\n  return elem;\n}\n/* 创建dom元素 */\nexport function objectFilter(obj, keys, def){\n  let result = {};\n  isType(obj, 'object') && isType(keys, 'array') && keys.forEach(item => {\n    obj.hasOwnProperty(item) ? (result[item] = obj[item]) : (def && (result[item] = undefined));\n  })\n  return result;\n}\n/* 对象数组按某一键值排序 */\nexport function isType(value, type){\n  return (typeof type === 'string') ? Object.prototype.toString.call(value).toLowerCase() === `[object ${type.toLowerCase()}]` : null;\n}\n/* 判断变量是否是数字或数字字符串 */\nexport function isNumeric(obj) {  \n  return (isType(obj, 'number') || isType(obj, 'string')) && !isNaN( obj - parseFloat( obj ) );\n}\n/* json数据拷贝 */\nexport function jsonCopy(obj) {  \n  return JSON.parse(JSON.stringify(obj));\n}\n/* 对象数组按某一键值排序 */\nexport function objKeySort(obj_arr=[],key='',desc=false){\n  return obj_arr.sort((a,b)=>{\n    if(a[key] !== undefined && b[key] !== undefined){\n      if(a[key] < b[key]){\n        return desc ? 1 : -1;\n      }\n      else if(a[key] > b[key]){\n        return desc ? -1 : 1;\n      }\n      else {\n        return 0;\n      }\n    }\n    else {\n      return 0;\n    }\n  })\n}\n/* 角度转化弧度 */\nexport function deg2rad(deg){\n  return Math.PI/180*deg;\n}\n/* 三次贝塞尔曲线 */\nexport function cubicBezier(p1_x,p1_y,p2_x,p2_y){\n  var ax,bx,cx,ay,by,cy;\n  /*计算多项式系数*/\n  cx = 3.0 * (p1_x - 0);  \n  bx = 3.0 * (p2_x - p1_x) - cx;  \n  ax = 1 - 0 - cx - bx;  \n\n  cy = 3.0 * (p1_y - 0);  \n  by = 3.0 * (p2_y - p1_y) - cy;  \n  ay = 1 - 0 - cy - by;  \n  return function(x) {\n    let tSquared = x * x,\n        tCubed = tSquared * x;\n    return ay * tCubed + by * tSquared + cy * x;\n  }\n}\n/* 约等于函数 */\nexport function approximate(comp1,comp2,precision=0){\n  return Math.abs(comp1 - comp2) < Math.pow(10,precision);\n}\n/* 错误处理 */\nexport function errWarn(error) {\n  console.log(error);\n}","import {isType} from '../utils';\n/*\n* 精灵类，用于处理各种精灵对象的绘制和行为\n* \n*/\nexport default class Sprite {\n  constructor(name='',args={}, painter=null, behaviors={}){\n    this.name = name;\n    this.painter = painter;\n    this.behaviors = behaviors;\n    this.top = 0; \n    this.left = 0;\n    this.width = 10; \n    this.height = 10;\n    this.velocityX = 0;\n    this.velocityY = 0;\n    this.rotateVelocity = 0;\n    this.rotate = 0;\n    this.opacity = 1;\n    this.visible = true;\n    this.animating = false;\n    this.zindex = 0;\n    this.destroy = false;\n    this.data = {};\n    this.media = {};\n    this._startTime = 0;\n    this.initArgs(args);\n    this.rotatePoint = {x:this.left+this.width/2,y:this.top+this.height/2};\n    return this;\n  }\n  initArgs(args) {\n    Object.assign(this, args);\n    Object.assign(this.media, this.initMedia());\n  }\n  initMedia() {\n    return {\n      play: function(name) {\n        this[name].play && this[name].play();\n      },\n      pause: function(name) {\n        this[name].pause && this[name].pause();\n      }\n    }\n  }\n  /*设置精灵路径*/\n  setPath(fn){\n    isType(fn, 'function') && (this.path = fn);\n  }\n  paint(context, time, fdelta, data) {\n    if(this.painter && this.painter.paint && this.visible){\n      this.painter.paint(this, context, time, fdelta, data);\n    }\n  }\n  update(time, fdelta, data, context) {\n    !this._startTime && (this._startTime = time);\n    this._runBehaviors(time, fdelta, data, context);\n  }\n\n  _runBehaviors(time, fdelta, data, context) {\n    let {behaviors, _startTime} = this;\n    for(let i of Object.keys(behaviors)){\n      let behavior = behaviors[i];\n      if(behavior.delay){\n        if(time - _startTime - behavior.delay < 0){\n          continue;\n        }\n        time = time - _startTime - behavior.delay;\n      }\n      isType(behavior.execute, 'function') && behavior.execute(this, time, fdelta, data, context);\n    }\n  }\n\n}","import Sprite from './sprite';\nimport {isType, objKeySort} from '../utils';\n/*\n* 图层类，用于提供多层容器\n* \n*/\nexport default class Layer extends Sprite {\n  constructor(name='', args={}, painter=null, behaviors={}){\n    super();\n    this.layers = [];\n    this.sprites = [];\n    this.name = name;\n    this.painter = painter;\n    this.behaviors = isType(behaviors, 'object') ? behaviors : {};\n    Object.assign(this, args);\n  }\n  paint(context,time,fdelta,data) {\n    if(this.painter && this.painter.paint){\n      this.painter.paint(this,context,time,fdelta);\n    }\n    let paintFn = i => i.paint &&　i.paint(context, time, fdelta);\n    this.sprites.forEach(paintFn);\n    this.layers.forEach(paintFn);\n  }\n  update(time, fdelta, data, context) {\n    this._runBehaviors(time, fdelta, data, context);\n    let updateFn = (i, index, arr) => {\n      i.destroy && arr.splice(index, 1);\n      i.update &&　i.update(time, fdelta, data, context);\n    }\n    this.sprites.forEach(updateFn);\n    this.layers.forEach(updateFn);\n  }\n  /*添加精灵*/\n  addLayer(...layer){\n    let { layers } = this;\n    layers.push(...layer);\n    objKeySort(layers, 'zindex');\n  }\n  /*添加精灵*/\n  addSprite(...sprite){\n    let { sprites } = this;\n    sprites.push(...sprite);\n    objKeySort(sprites, 'zindex');\n  }\n}\n\nexport class BaseLayer extends Layer {\n  isStatic = false;\n  constructor(name='', args={}, painter=null, behaviors={}){\n    super(`BASELAYER-${name}`, args, painter, behaviors);\n\n  }\n  paint(context, time, fdelta, data){\n    if(!this.isStatic) {\n      let {width, height} = this;\n      context.clearRect(0, 0, width, height);\n      super.paint(context, time, fdelta, data);\n    }\n  }\n}","import {BaseLayer} from './Layer';\nimport {isType, isNumeric, createHtmlElement, objectFilter, errWarn} from '../utils';\n\nexport default class Stage {\n  _playing = true;\n  constructor(name, options) {\n    this.$canvas = this.elemInit(name, options);\n    this.resetOptions(options, true);\n    this.stageInit();\n    this.$layers = {};\n  }\n  resetOptions(options, fresh){\n    (fresh || !this._options) ? (this._options = Object.assign({}, options)) : Object.assign(this._options, options);\n  }\n  elemInit(name, options) {\n    let attrs = objectFilter(options, ['width', 'height']);\n    let styles = Object.assign({}, options, {position: 'absolute'});\n    let canvasEle = isType(name, 'string') ? createHtmlElement('canvas', attrs, styles) : name;\n    canvasEle = isType(canvasEle, 'HTMLCanvasElement') ? canvasEle : null;\n    canvasEle && (canvasEle.id = 'AC_' + name);\n    return canvasEle;\n  }\n  stageInit() {\n    let args = objectFilter(this._options, ['width', 'height']);\n    this._stage = new BaseLayer(name, args);\n    if(this.$canvas){\n      this._ctx = this.$canvas.getContext('2d');\n    }\n    else {\n      errWarn('no accessable canvas element!');\n    }\n  }\n  update = (elapsed, fdelta, data) => {\n    if(this._playing) {\n      let context = this._ctx;\n      this._stage.update(elapsed, fdelta, data, context);\n      this._stage.paint(context, elapsed, fdelta, data);\n    }\n  }\n  play(){\n    this._playing = true;\n  }\n  pause() {\n    this._playing = false;\n  }\n  setCanvasSize() {\n    let {width, height} = this._options;\n    if(isNumeric(width) && isNumeric(height)) {\n      Object.assign(this.$canvas, {width, height});\n    }\n  }\n  \n  addLayer = (...layer) => {\n    this._stage.addLayer(...layer);\n  }\n  addSprite = (...sprite) => {\n    this._stage.addSprite(...sprite);\n  }\n  resize() {\n    this.setCanvasSize();\n  }\n\n}","import {isType} from '../utils';\n/*\n* 精灵类，用于处理各种精灵对象的绘制和行为\n* \n*/\nexport default class Sprite {\n  constructor(name='',args={}, painter=null, behaviors={}){\n    this.name = name;\n    this.painter = painter;\n    this.behaviors = behaviors;\n    this.top = 0; \n    this.left = 0;\n    this.width = 10; \n    this.height = 10;\n    this.velocityX = 0;\n    this.velocityY = 0;\n    this.rotateVelocity = 0;\n    this.rotate = 0;\n    this.opacity = 1;\n    this.visible = true;\n    this.animating = false;\n    this.zindex = 0;\n    this.destroy = false;\n    this.data = {};\n    this.media = {};\n    this._startTime = 0;\n    this.initArgs(args);\n    this.rotatePoint = {x:this.left+this.width/2,y:this.top+this.height/2};\n    return this;\n  }\n  initArgs(args) {\n    Object.assign(this, args);\n    Object.assign(this.media, this.initMedia());\n  }\n  initMedia() {\n    return {\n      play: function(name) {\n        this[name].play && this[name].play();\n      },\n      pause: function(name) {\n        this[name].pause && this[name].pause();\n      }\n    }\n  }\n  /*设置精灵路径*/\n  setPath(fn){\n    isType(fn, 'function') && (this.path = fn);\n  }\n  paint(context, time, fdelta, data) {\n    if(this.painter && this.painter.paint && this.visible){\n      this.painter.paint(this, context, time, fdelta, data);\n    }\n  }\n  update(time, fdelta, data, context) {\n    !this._startTime && (this._startTime = time);\n    this._runBehaviors(time, fdelta, data, context);\n  }\n\n  _runBehaviors(time, fdelta, data, context) {\n    let {behaviors, _startTime} = this;\n    for(let i of Object.keys(behaviors)){\n      let behavior = behaviors[i];\n      if(behavior.delay){\n        if(time - _startTime - behavior.delay < 0){\n          continue;\n        }\n        time = time - _startTime - behavior.delay;\n      }\n      isType(behavior.execute, 'function') && behavior.execute(this, time, fdelta, data, context);\n    }\n  }\n\n}","import {isType, deg2rad} from '../utils';\n/*\n* 绘制器基础类，用于提供基础的绘制器逻辑方便扩展\n* \n*/\nexport default class Painter {\n  constructor(paint){\n    this.image = null;\n    this.paint_queue = [];\n    this.photo = null;\n    isType(paint, 'function') && (this.paint = paint.bind(this));\n  }\n  paint(sprite,context,time,fdelta,data) {\n    \n  }\n  addQueueFn(fn){\n    let add_fn = isType(fn, 'function') ? fn : (isType(this[fn], 'function') ? this[fn] : null);\n    add_fn && this.paint_queue.push(add_fn);\n  }\n  clearQueue(){\n    this.paint_queue = [];\n  }\n  runQueue(sprite,context,time,fdelta,data){\n    let queue = this.paint_queue;\n    for(let i=0; i < queue.length; i++){\n      queue[i](sprite,context,time,fdelta,data);\n    }\n  }\n  _setSelfStyles(sprite,context) {\n    if(sprite.opacity < 1){\n      context.globalAlpha = sprite.opacity > 0 ? sprite.opacity : 0;\n    }\n  }\n  rotate(sprite,context,time,fdelta,data){\n    context.translate(sprite.rotatePoint.x, sprite.rotatePoint.y);\n    context.rotate(deg2rad(sprite.rotate));\n    sprite.left = - sprite.width / 2;\n    sprite.top = - sprite.height / 2;\n  }\n  getPhoto(sprite,context) {\n    sprite.data.photo = context.getImageData(sprite.left, sprite.top, sprite.width, sprite.height);\n  }\n  putPhoto(sprite,context) {\n    context.putImageData(sprite.data.photo, sprite.left, sprite.top);\n  }\n}\n","import Painter from './Painter'\n\n/*图片绘画类\n*\n*\n*/\nexport class ImagePainter extends Painter{\n  /*\n  * @param img 图片\n  * @param set 绘制图片的参数\n  */\n  constructor(img = null, set){\n    super();\n    this.image = img;\n    this.imgSet = set ? set : {x: 0, y: 0, w: img && img.width, h: img && img.height};\n  }\n  paint(sprite, context, time, fdelta, data) {\n    if(this.image) {\n      context.save();\n      let spriteCopy = Object.assign({}, sprite);\n      this._setSelfStyles(spriteCopy, context);\n      this.runQueue(spriteCopy, context, time, fdelta, data);\n      let imgSet = this.imgSet;\n      \n      context.drawImage(this.image, imgSet.x, imgSet.y, imgSet.w, imgSet.h, spriteCopy.left, spriteCopy.top, spriteCopy.width, spriteCopy.height);\n      context.restore();\n    }\n  }\n  \n}\n/*精灵绘画类\n*\n*\n*/\nexport class SheetPainter extends Painter{\n  /*\n  * @param img 图片\n  * @param set 绘制图片的参数\n  */\n  constructor(img,cells,{interval = 1000,autoruning = false,iteration = 1,reverse = false}){\n    super();\n    this.image = img;\n    this.cells = cells;\n    this.reverse = reverse;\n    this.cell_index = reverse ? (this.cells.length - 1) : 0;\n    this.interval = interval;\n    this.running = autoruning ? true : false;\n    this.frame_point = 0;\n    this.timeline = 0;\n    this.iteration = iteration == 'infinite' ? iteration : parseInt(iteration);\n    this._countFramePoint(this.cell_index);\n  }\n  /*索引递增/递减*/\n  advance() {\n    if(this.reverse ? (this.cell_index == 1) : (this.cell_index == this.cells.length-2)){\n      this.frame_point = this.timeline = 0;\n      Number.isInteger(this.iteration) && this.iteration--;\n    }\n    this.reverse ? (this.cell_index += this.cells.length - 1) : this.cell_index ++;\n    this.cell_index %= this.cells.length;\n    this._countFramePoint(this.cell_index);\n    \n  }\n  /*关键帧时间点计算*/\n  _countFramePoint(index){\n    let next_index = (this.reverse ? (index + this.cells.length - 1) : index + 1) % this.cells.length;\n    this.frame_point += this._sValue(this.cells[next_index].interval,this.interval);\n  }\n  /*跳帧*/\n  skip(frame_index){\n    this.cell_index = frame_index % this.cells.length;\n  }\n  paint(sprite,context,time,fdelta,data) {\n    if(this.running){\n      if(this.iteration > 0 || this.iteration == 'infinite'){\n        if(this.timeline >= this.frame_point ){\n          this.advance();\n        }\n      }\n      let cell = this.cells[this.cell_index],\n        sheet_img = cell.img ? this.image[cell.img] : this.image,\n        sv = this._sValue;\n      context.save();\n      context.drawImage(sheet_img,cell.x,cell.y,cell.w,cell.h,sv(cell.sl,sprite.left),sv(cell.st,sprite.top),sv(cell.sw,sprite.width),sv(cell.sh,sprite.height));\n      \n      this.timeline += fdelta;\n      //console.log(this.timeline,this.frame_point)\n      context.restore();\n    }\n  }\n  /*获取有效值*/\n  _sValue(cell_val,sprite_val) {\n    return Number.isFinite(cell_val) ? cell_val : sprite_val;\n  }\n  \n}","import { isType } from '../utils';\n/*\n* 动画时间控制器类，用于提供与动画时间播放相关的功能\n* \n*/\nexport default class AnimationTimer {\n  constructor(animation){\n    this._animation = isType(animation, 'function') ? animation : function(){};\n    this.startTime = 0;\n    this.lastTime = 0;\n    this.running = false;\n    this._playing = false;\n    this.time = 0;\n    this.elapsed = 0;\n    this._animHandle = null;\n  }\n  start() {\n    if(!this.running) {\n      this.startTime = +new Date();\n      this.running = true;\n      this.play();\n      let animation = (time) => {\n        if(this._playing){\n          if(!this.lastTime){\n            this.lastTime = time;\n          }\n          else{\n            this.time = time - this.lastTime;\n            this.elapsed += this.time;\n            this.lastTime = time;\n            this._animation(this.elapsed, this.time);\n          }\n        }\n        this._animHandle = window.requestAnimationFrame(animation);\n      }\n      this._animHandle = window.requestAnimationFrame(animation);\n    }\n  }\n  play() {\n    this._playing = true;\n  }\n  pause() {\n    this.lastTime = 0;\n    this._playing = false;\n  }\n  stop() {\n    this.elapsed = (+new Date()) - this.startTime;\n    this.running = false;\n    window.cancelAnimationFrame(this._animHandle);\n  }\n  getElapsedTime(){\n    if(this.running){\n      return (+new Date()) - this.startTime;\n    }\n    else{\n      return this.elapsed;\n    }\n  }\n  getRuningTime(){\n    return this.time;\n  }\n  getNextTime() {\n    let trueTime = this.time,\n        percentComplete = trueTime / this.duration;\n    if(!this.running) return undefined;\n    if(this.timeWrap == undefined) return elapsedTime;\n    return elapsedTime * (this.timeWarp(percentComplete) / percentComplete);\n  }\n  isRunning() {\n    return this.running;\n  }\n  reset(){\n    this.elapsed = 0;\n  }\n  static getWarpTime(warp_fn,time,duration){\n    if(typeof warp_fn == 'function'){\n      let percent = time/duration;\n      return time * warp_fn(percent)/percent;\n    }\n  }\n  /*基础事件控制函数*/\n  static easeIn(strength){\n    return function(percent_complete){\n      return Math.pow(percent_complete,strength*2);\n    }\n  }\n  static easeOut(strength){\n    return function(percent_complete){\n      return 1 - Math.pow(1 - percent_complete,strength*2);\n    }\n  }\n  static easeInOut(){\n    return function(percent_complete){\n      return percent_complete - Math.sin(percent_complete*2*Math.PI) / (2*Math.PI);\n    }\n  }\n  static elastic(passes) {\n    passes = passes || this.def_opts.elastic_passes;\n    return function (percent_complete){\n      return ((1-Math.cos(percent_complete*Math.PI*passes)) * (1 - percent_complete))+percent_complete;\n    }\n  }\n  static bounce(bounces) {\n    let fn = AnimationTimer.elastic(bounces);\n    return function() {\n      percent_complete = fn(percent_complete);\n      return percent_complete <= 1 ? percent_complete : 2 - percent_complete;\n    }\n  }\n  static linear() {\n    return function(percent_complete){\n      return percent_complete;\n    }\n  }\n  static step() {\n    return function(percent_complete){\n      return percent_complete;\n    }\n  }\n}","import AnimationTimer from './AnimationTimer';\nimport {isType, jsonCopy, isNumeric} from '../utils';\n/*\n* 动画时间控制器类，用于提供与动画时间播放相关的功能\n* \n*/\nexport default class Behavior {\n  constructor(args, execute){\n    let defArgs = {\n      firstFn : null,  //行为首次运行时运行的函数\n      animation : null,   //动画行为对象\n      iteration : 1,  //行为运行次数\n      timing : null,   //时间函数,\n      fillMode: null  //时间结束后样式\n    };\n    Object.assign(this, defArgs, args);\n    /*此部分为精灵行为基础属性*/\n    // 确认行为执行函数\n    this.executeFn = isType(execute, 'function') ? execute : ( this.animation ? this._attrChange : function(){});\n    // 确定时间轴函数\n    this.timing = isType(this.timing, 'function') ? this.timing : (isType(AnimationTimer[this.timing], 'function') ? AnimationTimer[this.timing](this.timingArgs) : null);\n    this.firstFn = isType(this.firstFn, 'function') ? this.firstFn : ()=>{}; // 行为首次运行函数\n    this._firstRun = false;      // 精灵行为首次运行标记\n    this._iterationCount = 0;    // 行为已重复运行次数\n    this._spriteAttrs = {};      // 精灵初始属性记录对象\n    /*以下为精灵动画行为专属属性*/\n    this._animaProps = this._animaInitProps();  \n    this._animaRuntime = null;   //动画运行环境数据\n    /*初始化函数*/\n  }\n  _animaInitProps(){\n    return {         //动画初始属性\n      velocity : {left:0, top:0, rotate:0, width:0, height:0, opacity:0, rotate:0},  //支持的动画属性\n      lastFrame : 0,             //上一帧时间点\n      frameDuration : 0,         //关键帧间隔\n      framesTime :[]             //运行中的帧时间点\n    };\n  }\n  execute(sprite, time, fdelta, data, context){\n    /*单次执行，用于计算初始值*/\n    if(!this._firstRun){\n      this._remeberAttrs(sprite);\n      this._animationPrepare(sprite);\n      this.firstFn();\n      this._iterationCount ++;\n      this._firstRun = true;\n    }\n    \n    /*行为逻辑*/\n    let repeatCount = Math.floor(time / this.duration);\n    if(repeatCount === this._iterationCount){\n      if(this._checkIterationCount(repeatCount)) {\n        this._iterationCount ++;\n        this._animationPrepare(sprite);\n      }\n      (this.fillMode !== 'forward') && this._remeberAttrs(sprite, true);\n    }\n    if(this._checkIterationCount(repeatCount)){\n      time %= this.duration;\n      /*动画执行流程*/\n      if(this.animation){\n        let {_animaRuntime: runtime, animation} = this,\n            curFrame = runtime.framesTime[0];\n        if(time >= this._countFrameDuration(curFrame)){\n          let lastFrame = runtime.lastFrame = runtime.framesTime.shift();\n          curFrame = runtime.framesTime[0];\n          runtime.frameDuration = this._countFrameDuration(curFrame - lastFrame);\n          runtime.velocity = this._attrChangeInit(sprite, animation[curFrame], runtime.frameDuration);\n        }\n        //let animaTime = time - runtime.lastFrame;\n        if(this.timing && runtime.frameDuration){\n          let newTime = this._warpTime(time, runtime.frameDuration);\n          time = newTime[0];\n          fdelta = newTime[1];\n        }\n        \n      }\n      else if(this.timing && this.duration){\n        /*时间轴扭曲逻辑*/\n        let newTime = this._warpTime(time, this.duration);\n        time = newTime[0];\n        fdelta = newTime[1];\n      }\n      /*行为逻辑函数*/\n      this.executeFn(sprite, time, fdelta, data, context);\n    }\n    else{\n      isType(this.animateCallback, 'function') && this.animateCallback(sprite, context);\n      delete sprite.behaviors[this.name]; //行为执行完销毁自身W\n    }\n    \n  }\n  _countFrameDuration(percent) {\n    return percent * this.duration / 100;\n  }\n  _checkIterationCount(repeatCount) {\n    return this.iteration === 'infinite' ? true : (repeatCount < this.iteration);\n  }\n  /*重置行为动画运行数据*/\n  _animationPrepare(sprite) {\n    if(this.animation){\n      this._setAnimaData();\n      (!this.animation['0'] && !this.animation['100']) && (this.animation = {0: null, 100: this.animation}); //处理单层数据\n      let {animation, _animaRuntime} = this;\n      \n      for(let i in animation){\n        (i === 0 && animation[0]) && this._spriteAttrSet(sprite, animation[0], true);\n        _animaRuntime['framesTime'].push(i); \n      }\n      _animaRuntime['framesTime'].sort((a, b)=>(a - b));\n    }\n  }\n  /*重置行为动画运行数据*/\n  _setAnimaData() {\n    this._animaRuntime = this._animaInitProps();  //重置动画运行环境数据\n  }\n  /* 时间轴扭曲函数\n  * @param time 行为运行时间\n  */\n  _warpTime(time,duration){\n    let percent = time / duration;\n    let warpTime = this.timing(percent)/percent*time;\n    !this.lastTime && (this.lastTime = warpTime);\n    let warp_fdelta = warpTime - this.lastTime;\n    this.lastTime = warpTime;\n    this.orgTime = [warpTime,warp_fdelta];\n    return this.orgTime;\n  }\n  /*属性变换初始化函数*/\n  _attrChangeInit(sprite, animaArgs, duration){\n    let animaVel = {};\n    for(let i in animaArgs){\n      let arg = animaArgs[i],\n          relativeVal = 0;\n      if(typeof arg === 'string'){\n        relativeVal = this._handleRelativeValue(arg);\n      }\n      else{\n        relativeVal = arg - sprite[i];\n      }\n      animaVel[i] = relativeVal / duration;\n    }\n    return animaVel;\n  }\n  \n  /*属性变换函数*/\n  _attrChange(sprite, time, fdelta, data, context){\n    let { velocity } = this._animaRuntime;\n\n    for(let i in velocity){\n      sprite[i] += velocity[i] * fdelta;\n    }\n  }\n  /*属性设置函数*/\n  _spriteAttrSet(sprite, attrs, checkRel){\n    for(let i in attrs){\n      sprite[i] = checkRel ? this._handleRelativeValue(attrs[i], sprite[i]) : attrs[i];\n    }\n  }\n  _handleRelativeValue(relVal, value){\n    let result = 0;\n    if(typeof relVal === 'string' && relVal.indexOf('=') > 0){\n      let relValArr = relVal.split('=');\n      switch(relValArr[0]){\n        case '+':\n          result = relValArr[1] - 0;\n          break;\n        case '-':\n          result = -relValArr[1];\n          break;\n      }\n    }\n    isNumeric(value) && (result += value);\n    return result;\n  }\n  /* 精灵属性记录/恢复函数 */\n  _remeberAttrs(sprite, restore){\n    if(Object.keys(sprite.behaviors).length === 1 && (this.iteration > 1 || this.iteration === 'infinite')){\n      let {_spriteAttrs, _animaProps: {velocity}} = this;\n      if(Object.keys(_spriteAttrs).length === 0 && !restore){\n        for(let i in velocity){\n          _spriteAttrs[i] = sprite[i];\n        }\n      }\n      if(restore && _spriteAttrs){\n        this._spriteAttrSet(sprite, _spriteAttrs);\n      }\n    }\n  }\n}","/*\n* 资源加载模块类，用于加载资源\n* \n*/\nexport default class MediaLoader {\n  constructor(){\n    this.imagesInfo = this._mediaInfoObj();\n    this.images = {};\n    this.audiosInfo = this._mediaInfoObj();\n    this.audios = {};\n  }\n  _mediaInfoObj(){\n    return {\n      total : {s:0, f:0, t:0},\n      queue : {s:0, f:0, t:0},\n      urls : []\n    };\n  }\n  /*加载资源*/\n  loadingMedia(mediaObj, callback) {\n    this.loadingImages(mediaObj.images || {}, callback, true);\n    this.loadingAudios(mediaObj.audios || {}, callback, true);\n    return this;\n  }\n  loadingMediaList(type, mediaList={},callback=null,checkall = false){\n    let isArray = Array.isArray(mediaList) ? true : false;\n    let mediaInfo = this[type + 'Info'];\n    let loadingFn = null;\n    if(type === 'images') {\n      loadingFn = this.loadImage;\n    }\n    else if(type === 'audios') {\n      loadingFn = this.loadAudio;\n    }\n    if(mediaList && mediaInfo && loadingFn){\n      mediaInfo.queue = {s: 0, f: 0, t: 0};\n      for(let i in mediaList){\n        let key = isArray ? mediaList[i] : i;\n        loadingFn(key, mediaList[i], callback, checkall);\n      }\n    }\n    return this;\n  }\n  /*加载图片,返回对象实例*/\n  loadingImages(imageList={},callback=null,checkall = false){\n    return this.loadingMediaList('images', imageList, callback, checkall);\n  }\n  loadMedias(type, key, mediaUrl, callback, checkall){\n    let mediaInfo = this[type + 'Info'];\n    if(Array.indexOf(mediaInfo['urls'], mediaUrl) < 0){\n      mediaInfo.total.t++;\n      mediaInfo.queue.t++;\n      mediaInfo['urls'].push(mediaUrl);\n      let checkFn = checkall && this.getMediaProgress;\n      let mediaEle = null;\n      let loadEventName = 'load';\n      let loadedFn = () => {\n        mediaInfo.total.s++;\n        mediaInfo.queue.s++;\n        if(checkFn()[2] == 100){\n          callback();\n        }\n      };\n      let errorFn = () => {\n        mediaInfo.total.f++;\n        mediaInfo.queue.f++;\n        if(checkFn()[2] == 100){\n          callback();\n        }\n      }\n      if(type === 'images') {\n        mediaEle = new Image();\n        !checkall && (checkFn = this.getImageProgress);\n      }\n      else if(type === 'audios') {\n        mediaEle = new Audio();\n        !checkall && (checkFn = this.getAudioProgress);\n        loadEventName = 'loadedmetadata';\n      }\n      if(mediaEle) {\n        mediaEle.addEventListener(loadEventName,loadedFn);\n        mediaEle.addEventListener('error',errorFn)\n        mediaEle.src = mediaUrl;\n        this[type][key] = mediaEle;\n      }\n      \n    }\n  }\n  loadImage = (key, imgUrl, callback, checkall) =>{\n    this.loadMedias('images', key, imgUrl, callback, checkall)\n  }\n  /*获取图片加载进度，输出为[加载数，总数，百分比]的数组格式*/\n  getImageProgress = () => {\n    return this.getProgress('images');\n  }\n  /*加载音频资源,返回对象实例*/\n  loadingAudios(audioList={}, callback=null, checkall = false){\n    return this.loadingMediaList('audios', audioList, callback, checkall);\n  }\n  loadAudio = (key, audioUrl, callback, checkall) => {\n    this.loadMedias('audios', key, audioUrl, callback, checkall)\n  }\n  getAudioProgress = () => {\n    return this.getProgress('audios');\n  }\n  getProgress(type){\n    let { queue } = this[type + 'Info'],\n        loaded = queue.s + queue.f,\n        percent = Math.round(loaded / queue.t * 100);\n    return [loaded,queue.t,percent];\n  }\n  /*获取总资源加载进度*/\n  getMediaProgress = () => {\n    let images = this.imagesInfo.queue,\n        audios = this.audiosInfo.queue,\n        loaded = audios.s + audios.f + images.s + images.f,\n        total = audios.t + images.t,\n        percent = Math.round(loaded / total * 100);\n    return [loaded,total,percent];\n  }\n  \n}","import {Stage, Sprite, Layer, Painter, ImagePainter, SheetPainter, Behavior, AnimationTimer, MediaLoader} from './core';\nimport {BaseLayer} from './core/Layer';\nimport {isType, isNumeric, objKeySort, errWarn} from './utils';\n\nexport default class Anicanvas {\n  _RAF = 0;\n  _stages = [];\n  $stages = {};\n  $stage = null;\n  $layers = {};\n  $media = new MediaLoader();\n  constructor(elem, opts) {\n    this._elem = this.elemInit(elem);\n    this._options = Object.assign({}, opts);\n    this._aniTimer = new AnimationTimer(this.animation);\n    this.stageInit();\n  }\n  elemInit(elem) {\n    return isType(elem, 'string') ? document.querySelector(elem) : null;\n  }\n  stageInit() {\n    if(this._elem){\n      let {width, height} = this._options;\n      this.createStage('MAIN', {width, height, zIndex: 1000});\n      this.$stage = this.$stages.MAIN;\n    }\n    else {\n      errWarn('no accessable root element!');\n    }\n  }\n  createStage(name, options){\n    if(isType(name, 'string') && !this.$stages[name]){\n      let {width, height} = this._options;\n      !options.width && (options.width = width);\n      !options.height && (options.height = height);\n      let stage = new Stage(name, options);\n      this.$stages[name] = stage;\n      this._stages.push(stage);\n      objKeySort(this._stages, 'zIndex');\n      this._elem.appendChild(stage.$canvas);\n    }\n  }\n  animation = (elapsed, fdelta) => {\n    this._stages.forEach(stage => (stage.update(elapsed, fdelta)));\n  }\n  start(){\n    this._aniTimer.start();\n  }\n  play(){\n    this._aniTimer.play();\n  }\n  pause() {\n    this._aniTimer.pause();\n  }\n  stop() {\n    this._aniTimer.stop();\n  }\n  setCanvasSize() {\n    let {width, height} = this._options;\n    if(isNumeric(width) && isNumeric(height)) {\n      Object.assign(this.canvas, {width, height});\n    }\n  }\n  loadingMedia(mediaMap, callback) {\n    if(mediaMap.images || mediaMap.audios){\n      this.$media.loadingMedia(mediaMap, callback);\n    }\n  }\n  createPainter(type, ...options){\n    switch(type) {\n      case 'image':\n        return new ImagePainter([...options]);\n        break;\n      case 'sheet':\n        return new SheetPainter([...options]);\n        break;\n      default:\n        return new Painter(type);\n        break;\n    }\n  }\n  createLayer = (name, options, painter) => {\n    if(isType(name, 'string')) {\n      let opts = null\n      if(isType(options, 'function')) {\n        painter = options;\n      }\n      else{\n        opts = options === 'fullpage' ? {width: this._options.width, height: this._options.height} : options;\n      }\n      this.$layers[name] = new Layer(name, opts, painter);\n      return this.$layers[name];\n    }\n  }\n  addLayer = (...layer) => {\n    this.$stage.addLayer(...layer);\n  }  \n  addSprite = (...sprite) => {\n    this.$stage.addSprite(...sprite);\n  }\n  resize(sizes) {\n    isType(size, 'object') && Object.assign(this._elem, sizes);\n  }\n\n  \n  static Sprite = Sprite;\n  static Layer = Layer;\n  static Painter = Painter;\n  static ImagePainter = ImagePainter;\n  static SheetPainter = SheetPainter;\n  static Behavior = Behavior;\n}"],"names":["createHtmlElement","tag","attrs","styles","elem","document","createElement","isType","Object","assign","style","objectFilter","obj","keys","def","result","forEach","hasOwnProperty","item","undefined","value","type","prototype","toString","call","toLowerCase","isNumeric","isNaN","parseFloat","objKeySort","obj_arr","key","desc","sort","a","b","deg2rad","deg","Math","PI","errWarn","error","console","log","Sprite","name","args","painter","behaviors","top","left","width","height","velocityX","velocityY","rotateVelocity","rotate","opacity","visible","animating","zindex","destroy","data","media","_startTime","initArgs","rotatePoint","x","y","initMedia","play","pause","fn","path","context","time","fdelta","paint","_runBehaviors","i","behavior","delay","execute","Layer","layers","sprites","paintFn","updateFn","index","arr","splice","update","push","BaseLayer","isStatic","clearRect","Stage","options","_playing","elapsed","_ctx","_stage","addLayer","addSprite","$canvas","elemInit","resetOptions","stageInit","$layers","fresh","_options","position","canvasEle","id","getContext","setCanvasSize","Painter","image","paint_queue","photo","bind","sprite","add_fn","queue","length","globalAlpha","translate","getImageData","putImageData","ImagePainter","img","set","imgSet","w","h","save","spriteCopy","_setSelfStyles","runQueue","drawImage","restore","SheetPainter","cells","interval","autoruning","iteration","reverse","cell_index","running","frame_point","timeline","parseInt","_countFramePoint","Number","isInteger","next_index","_sValue","frame_index","advance","cell","sheet_img","sv","sl","st","sw","sh","cell_val","sprite_val","isFinite","AnimationTimer","animation","_animation","startTime","lastTime","_animHandle","Date","window","requestAnimationFrame","cancelAnimationFrame","trueTime","percentComplete","duration","timeWrap","elapsedTime","timeWarp","warp_fn","percent","strength","percent_complete","pow","sin","passes","def_opts","elastic_passes","cos","bounces","elastic","Behavior","defArgs","firstFn","timing","fillMode","executeFn","_attrChange","timingArgs","_firstRun","_iterationCount","_spriteAttrs","_animaProps","_animaInitProps","_animaRuntime","velocity","lastFrame","frameDuration","framesTime","_remeberAttrs","_animationPrepare","repeatCount","floor","_checkIterationCount","runtime","curFrame","_countFrameDuration","shift","_attrChangeInit","newTime","_warpTime","animateCallback","_setAnimaData","_spriteAttrSet","warpTime","warp_fdelta","orgTime","animaArgs","animaVel","arg","relativeVal","_handleRelativeValue","checkRel","relVal","indexOf","relValArr","split","MediaLoader","loadImage","imgUrl","callback","checkall","loadMedias","getImageProgress","getProgress","loadAudio","audioUrl","getAudioProgress","getMediaProgress","images","imagesInfo","audios","audiosInfo","loaded","s","f","total","t","round","_mediaInfoObj","urls","mediaObj","loadingImages","loadingAudios","mediaList","isArray","Array","mediaInfo","loadingFn","imageList","loadingMediaList","mediaUrl","checkFn","mediaEle","loadEventName","loadedFn","errorFn","Image","Audio","addEventListener","src","audioList","Anicanvas","opts","_elem","_aniTimer","querySelector","createStage","zIndex","$stage","$stages","MAIN","stage","_stages","appendChild","start","stop","canvas","mediaMap","$media","loadingMedia","sizes","size","_RAF","createLayer"],"mappings":"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"}