{"version":3,"file":"index.es5.js","sources":["index.js"],"sourcesContent":["/*全局变量，用于存rem单位*/\r\n\r\n$(function(){\r\n  \r\n\tlet t,\r\n      app = new Invitation('#J-wrap');\r\n  $(window).resize(function(){\r\n    clearTimeout(t);\r\n    t = setTimeout(function(){\r\n      app.resize();\r\n    },500)\r\n    \r\n  });  \r\n});\r\n\r\n\r\nfunction getPageSize(){\r\n  return {width: $(window).width(), height: $(window).height()};\r\n}\r\n\r\n/*页面逻辑类*/\r\nclass Invitation{\r\n  constructor(elem){\r\n    this.envInit();\r\n    this.AC = new Anicanvas(elem, {...this.fullPageSize}); \r\n    this.pageInit();\r\n  }\r\n  envInit() {\r\n  \tthis.fullPageSize = getPageSize();\r\n  \tthis.rem = this.fullPageSize.width / 15;\r\n  }\r\n  resize(){\r\n  \tthis.envInit();\r\n  \tthis.AC.resize();\r\n  }\r\n  pageInit(){\r\n    /*\r\n    * 业务逻辑部分\r\n    */\r\n    //创建背景层\r\n    this.AC.createStage('background', {zIndex: 100});\r\n    this.AC.start();\r\n    //this.AC.$stage.pause();\r\n    //this.AC.$stages['background'].pause();\r\n    this.loadingMedia();\r\n    //this.test();\r\n  }\r\n  /*预加载资源*/\r\n  loadingMedia(){\r\n  \tlet preload_media = {\r\n      'images': {'bg1':'./img/bg.jpg','music':'./img/music.png','p1_01':'./img/p1_01.png','p1_02_01':'./img/p1_02_01.png','p1_02_02':'./img/p1_02_02.png','arrow':'./img/arrow.png','p1_03_01':'./img/p1_03_01.png','p1_03_02':'./img/p1_03_02.png','p1_03_03':'./img/p1_03_03.png'},\r\n      'audios':{'m1':'./media/bgm.mp3'}\r\n    };\r\n  \tthis.AC.loadingMedia(preload_media, this.drawPage);\r\n    this.drawLoadinProgress();\r\n  }\r\n  /*绘制进度条*/\r\n  drawLoadinProgress(){\r\n  \tlet rem = this.rem;\r\n  \tlet {height} = this.fullPageSize;\r\n  \tlet bgPainter = new Anicanvas.Painter( function(sprite, ctx, time, fdelta, data){\r\n  \t\tlet {left, top, width, height} = sprite;\r\n  \t\tctx.save();\r\n  \t\tctx.fillStyle = '#efefef';\r\n  \t\tctx.fillRect(left, top, width, height);\r\n  \t\tctx.restore();\r\n  \t});\r\n  \tlet layer = new Anicanvas.Sprite('progLayer', this.AC.$elemSize, bgPainter);\r\n\r\n  \tlet progbarPaniter = new Anicanvas.Painter( (sprite, ctx, time, fdelta, data) => {\r\n  \t\tlet {left, top, width, height, $data: {percent}} = sprite;\r\n  \t\tctx.save();\r\n  \t\tctx.fillStyle = '#aeaeae';\r\n  \t\tctx.fillRect(left, top, width, height);\r\n  \t\tctx.fillStyle = '#999999';\r\n  \t\tctx.fillRect(left, top, width * percent / 100, height);\r\n  \t\tctx.restore();\r\n  \t});\r\n    let progresUpdate = {\r\n      execute: (sprite, time)=>{\r\n        let mediaload = this.AC.$media.getImageProgress();\r\n        let percent = mediaload[2];\r\n        sprite.$data.percent = percent;\r\n        sprite.needUpdate = true;\r\n        (percent === 100) && (layer.destroy = true);\r\n      }\r\n    };\r\n  \tlet progressBar = new Anicanvas.Sprite('progbar', {left: 1*rem, top: height-40, width: 13*rem, height: 20}, progbarPaniter, [progresUpdate]);\r\n  \tlayer.append(progressBar);\r\n  \tthis.AC.$stages['background'].append(layer);\r\n  }\r\n\r\n  drawPage = () => {\r\n    let rem = this.rem,\r\n    \t\tcanvasSize = this.fullPageSize,\r\n    \t\t{ $media: {images, audios}, $elemSize, append } = this.AC,\r\n    \t\tpageLayer = new Anicanvas.Sprite('page', $elemSize, new Anicanvas.ImagePainter(images['bg1']));\r\n    \r\n    /*音乐播放按钮*/\r\n    let musicIcoPainter = new Anicanvas.ImagePainter(images['music']);\r\n    musicIcoPainter.addQueueFn('rotate');\r\n    let musicIco = new Anicanvas.Sprite('music', {\r\n\t    \ttop: 0.5 * rem, \r\n\t    \tleft: 0.865 * 15 * rem,\r\n\t    \twidth: 1.2 * rem,\r\n\t    \theight: 1.2 * rem,\r\n\t    \trotateVelocity: -45,\r\n\t    },\r\n    \tmusicIcoPainter, [{\r\n      \texecute : function(sprite, time, fdelta, data, context){\r\n        \tsprite.rotate = (sprite.rotate + fdelta/1000 * sprite.rotateVelocity ) % 360;\r\n      \t}\r\n    \t}]\r\n    );\r\n    musicIco.$media.music = audios['m1'];\r\n    musicIco.setPath(function(context){\r\n      let {left, top, width, height} = this;\r\n      let {left: pleft, top: ptop} = this.$parent;\r\n      left += pleft;\r\n      top += ptop;\r\n      context.arc(left + width/2, top + height/2, width / 2, 0, 2*Math.PI);\r\n    });\r\n    musicIco.on('click', function(event){\r\n      this.$media.music.paused ? this.$media.play('music'): this.$media.pause('music');\r\n    })\r\n    musicIco.$media.play('music');\r\n    \r\n    \r\n      \r\n    /*对话框*/\r\n    let dailogPainter = new Anicanvas.Painter((sprite,context,time,fdelta,data) => {\r\n      if(sprite.$data.photo){\r\n        dailogPainter.putPhoto(sprite, context);\r\n      }\r\n      else{\r\n        let dailog = images['p1_01'];\r\n        context.save();\r\n        if(sprite.opacity < 1){\r\n          context.globalAlpha = sprite.opacity > 0 ? sprite.opacity : 0;\r\n        }\r\n        context.drawImage(dailog, 0, 0, dailog.width, 398, sprite.left, sprite.top, sprite.width, sprite.height);\r\n        if(time > 2500){  \r\n        \tcontext.drawImage(dailog, 0, 400, dailog.width, 129, sprite.left, sprite.top+sprite.height*0.2513, sprite.width, sprite.height*0.3241);\r\n          dailogPainter.getPhoto(sprite, context);\r\n        }\r\n        context.restore();\r\n      }\r\n    });\r\n    let dailogBehavior = new Anicanvas.Behavior({\r\n      name: 'slideFadeDown',\r\n      timing: 'ease',\r\n      duration: 800,\r\n      delay: 700, \r\n      fillMode: 'forward', \r\n      animation:{ top:'+=20', opacity: 1}\r\n    });\r\n    let dailog = new Anicanvas.Sprite('dailog', {\r\n    \t\ttop: -20, \r\n    \t\tleft: 2.64*rem, \r\n    \t\topacity: 0, \r\n    \t\twidth: 8.8*rem, \r\n    \t\theight: 6.76*rem\r\n    \t},\r\n    \tdailogPainter, [dailogBehavior]\r\n    );\r\n    \r\n      \r\n    /*箭头动画*/\r\n    let arrowSlide = new Anicanvas.Behavior({\r\n    \tname: 'slideUpRepeat',\r\n    \tduration:2500,\r\n    \tdelay: 100,\r\n    \titeration: 'infinite',\r\n    \tanimation: {\r\n    \t\t0: {top: '+=8', opacity: 0},\r\n    \t\t30: {top: '-=3', opacity:1},\r\n    \t\t100: {top: '-=10', opacity:0}\r\n    \t}\r\n    });\r\n    let arrow = new Anicanvas.Sprite('arrow', {top:canvasSize.height-2*rem+8,left:6.92*rem,width:1.16*rem,opacity:0,height:1.16*rem}, new Anicanvas.ImagePainter(images['arrow']), [arrowSlide]);\r\n    \r\n\r\n      \r\n    /*背景*/\r\n    let midBgPanter = {\r\n      paint:(sprite,context,time,data)=>{\r\n        let midbg = sprite.$data.img;\r\n        if(midbg) {\r\n        \tcontext.save();\r\n\t        if(sprite.opacity < 1){\r\n\t          context.globalAlpha = sprite.opacity > 0 ? sprite.opacity : 0;\r\n\t        }\r\n\t        sprite.top += sprite.velocityY * data;  \r\n\t        context.drawImage(midbg,0,0,midbg.width,midbg.height,sprite.left,sprite.top + 20,sprite.width,sprite.height);\r\n\t        context.restore();\r\n        }\r\n      }\r\n    };\r\n    let midBgBehaviors = [{\r\n        name: 'slideUp',\r\n      \tdistance: -20, duration:800, delay:2500,\r\n        execute : function(sprite, time){\r\n          sprite.$data.img = images['p1_02_01'];\r\n          let deltat = time - sprite._startTime - this.delay;\r\n          if(deltat > 0){\r\n            sprite.velocityY = this.distance / this.duration;\r\n            let opacity = deltat / this.duration;\r\n            if(deltat >= 800){\r\n              sprite.velocityY = 0;\r\n              opacity = 1;\r\n              delete sprite.behaviors.slideUp;\r\n            }\r\n            sprite.opacity = opacity > 1 ? 1 : opacity;\r\n          }\r\n        }\r\n      }, {\r\n        name: 'bgswitch',\r\n      \tdelay: 3500,\r\n        execute : function(sprite, time){\r\n          let deltat = time - sprite._startTime - this.delay;\r\n          if(deltat > 0){\r\n            let skipt = deltat % 1000;\r\n            if(skipt < 500){\r\n              sprite.$data.img = images['p1_02_01'];\r\n            }\r\n            else{\r\n              sprite.$data.img = images['p1_02_02'];\r\n            }\r\n          }\r\n        }\r\n      }\r\n    ];\r\n\r\n    let midBgLayer = new Anicanvas.Sprite('midbg', {top: 6.96*rem+20, left:0.52*rem, width:13.52*rem, opacity:0, height:12.7*rem, data: {img:null}}, midBgPanter, midBgBehaviors);\r\n    /*人物*/\r\n    let peopleCell = [{x:0,y:0,w:268,h:384},{x:270,y:0,w:268,h:384},{x:540,y:0,w:268,h:384},{x:810,y:0,w:268,h:384}],\r\n        peoplePainter = new Anicanvas.SheetPainter(images['p1_03_01'], peopleCell, {interval:500, autoruning:true, iteration:'infinite'})\r\n    let people = new Anicanvas.Sprite('people', {left:2.2*rem,top:6.27*rem, width:10.72*rem,opacity:0,height:15.36*rem}, peoplePainter);\r\n\r\n    /*固定图片*/\r\n    let customPainter = {\r\n      paint:function(sprite,context,time,data){\r\n        let img = sprite.$data.img;\r\n        img && context.drawImage(img, 0, 0, img.width, img.height, sprite.left, sprite.top, sprite.width, sprite.height);\r\n      }\r\n    };\r\n    let floor = new Anicanvas.Sprite('floor', {top:19.31*rem, left:2.745*rem, width:10.56*rem, height:2.88*rem, $data:{ img: images['p1_03_03']}}, customPainter);\r\n    let desc = new Anicanvas.Sprite('desc', {top:14.275*rem, left:3.84*rem, width:7.02*rem, height:5.12*rem, $data:{img: images['p1_03_02']}}, customPainter);\r\n\r\n\r\n\r\n    this.AC.append(musicIco, midBgLayer, arrow, people, desc);\r\n    pageLayer.append(floor, dailog);\r\n    dailog.on('click', function(event){\r\n      console.log(this.name, event, 1);\r\n    });\r\n\r\n    pageLayer.on('click', ['dailog'], function(event){\r\n      console.log(this.name, event, 2)\r\n    })\r\n    this.AC.$stages['background'].append(pageLayer);\r\n      \r\n  }\r\n  test(){\r\n    let {rem} = this;\r\n    /*测试代码*/\r\n    let ballRoll = {\r\n      execute: (sprite, time)=>{\r\n        let {left, top, width, height} = sprite;\r\n        let {left: pleft, top: ptop, width: pwidth, height: pheight} = sprite.$parent;\r\n        if(left < pleft || left > pleft + pwidth - width) {\r\n          sprite.left = left < pleft? pleft : pleft + pwidth - width;\r\n          sprite.velocityX = -sprite.velocityX;\r\n        }\r\n        else if( top < ptop || top > ptop + pheight -height) {\r\n          sprite.top = top < ptop ? ptop : ptop + pheight -height;\r\n          sprite.velocityY = -sprite.velocityY;\r\n        }\r\n        sprite.left += sprite.velocityX;\r\n        sprite.top += sprite.velocityY;\r\n        sprite.rotatePoint = {x: sprite.left + sprite.width/2, y: sprite.top + sprite.height / 2};\r\n      }\r\n    };\r\n    let {width: swidth, height: sheight} = this.AC.$stage._stage;\r\n    for(let i = 0; i< 1; i++){\r\n      let width = 30 + Math.random() * 30;\r\n      let left = Math.random() * swidth - width;\r\n      let top = Math.random() * swidth - width;\r\n      let velocityX = 0; //Math.random() * 20;\r\n      let velocityY = 0; //Math.random() * 20;\r\n      let opacity = 0.2 + Math.random() * 0.8;\r\n      let ballPainter = new Anicanvas.Painter((sprite, context, time, fdelta)=>{\r\n        let { rotatePoint: {x, y}} = sprite; //\r\n        context.save();\r\n        context.beginPath();\r\n        context.globalAlpha = sprite.opacity;\r\n        context.fillStyle = \"red\";\r\n        context.arc(x, y, width / 2, 0, Math.PI*2);\r\n        context.fill();\r\n        context.restore();\r\n      })\r\n      let ball = new Anicanvas.Sprite('ball', {needAutoRP: true, left, top, width, height: width, opacity, velocityX, velocityY}, ballPainter, [ballRoll]);\r\n      ball.on('click', function(e){\r\n        if(!this.velocityX) {\r\n          this.velocityX = Math.random() * 2;\r\n          this.velocityY = Math.random() * 2;\r\n        }\r\n        else {\r\n          this.velocityX = this.velocityY = 0;\r\n        }\r\n      });\r\n      this.AC.append(ball);\r\n    }\r\n\r\n  }\r\n  \r\n}\r\n\r\n\r\n\r\n"],"names":["$","t","app","Invitation","window","resize","clearTimeout","setTimeout","getPageSize","width","height","elem","drawPage","rem","canvasSize","fullPageSize","AC","$media","images","audios","$elemSize","append","pageLayer","Anicanvas","Sprite","ImagePainter","musicIcoPainter","addQueueFn","musicIco","top","left","rotateVelocity","execute","sprite","time","fdelta","data","context","rotate","music","setPath","$parent","pleft","ptop","arc","Math","PI","on","event","paused","play","pause","dailogPainter","Painter","$data","photo","putPhoto","dailog","save","opacity","globalAlpha","drawImage","getPhoto","restore","dailogBehavior","Behavior","name","timing","duration","delay","fillMode","animation","arrowSlide","iteration","arrow","midBgPanter","paint","midbg","img","velocityY","midBgBehaviors","distance","deltat","_startTime","behaviors","slideUp","skipt","midBgLayer","peopleCell","x","y","w","h","peoplePainter","SheetPainter","interval","autoruning","people","customPainter","floor","desc","console","log","$stages","envInit","pageInit","createStage","zIndex","start","loadingMedia","preload_media","drawLoadinProgress","bgPainter","ctx","fillStyle","fillRect","layer","progbarPaniter","percent","progresUpdate","mediaload","getImageProgress","needUpdate","destroy","progressBar","ballRoll","pwidth","pheight","velocityX","rotatePoint","$stage","_stage","swidth","sheight","i","random","ballPainter","beginPath","fill","ball","needAutoRP","e"],"mappings":"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"}